<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ¨ AI Image Generator</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <script src="ai-app.js" defer></script>
</head>

<body>
  <div class="container" x-data="aiApp()">
    <h1>ğŸ¨ AI Image Generator</h1>

    <div class="prompt-section">
      <label for="prompt">Prompt (MÃ´ táº£ áº£nh báº¡n muá»‘n táº¡o)</label>
      <textarea x-model="prompt" placeholder="VÃ­ dá»¥: gá»™p cÃ¡c mÃ³n Äƒn trong áº£nh thÃ nh 1 poster Ä‘áº¹p"></textarea>
    </div>

    <div class="upload-section">
      <label>Upload áº¢nh</label>
      <button class="add-image-btn" @click="addImageSlot()">â• ThÃªm áº£nh</button>
      <div class="images-container">
        <template x-for="(slot, index) in imageSlots" :key="slot.id">
          <div class="image-item" :class="{ 'base-image': index === 0 }">
            <span class="image-label" x-text="index === 0 ? 'ğŸ¯ áº¢nh gá»‘c (Base Image)' : 'ğŸ“· áº¢nh tham kháº£o ' + index"></span>
            <div class="image-preview" :class="{ 'empty': !slot.preview }">
              <template x-if="slot.preview">
                <img :src="slot.preview" />
              </template>
              <template x-if="!slot.preview">
                <span>ChÆ°a chá»n áº£nh</span>
              </template>
            </div>
            <input type="file" accept="image/*" :id="'file-' + slot.id" @change="handleFileSelect(slot, $event)" hidden>
            <div class="image-actions">
              <button class="btn-upload" @click="document.getElementById('file-' + slot.id).click()">ğŸ“ Chá»n áº£nh</button>
              <button class="btn-delete" @click="deleteImageSlot(slot.id)" :disabled="index === 0 && imageSlots.length === 1">ğŸ—‘ï¸ XÃ³a</button>
            </div>
          </div>
        </template>
      </div>
    </div>

    <div class="submit-section">
      <button class="btn-generate" :disabled="loading" @click="generateImage()">
        <template x-if="!loading">ğŸš€ Táº¡o áº¢nh</template>
        <template x-if="loading">â³ Äang xá»­ lÃ½...</template>
      </button>
    </div>

    <div class="error-message" x-show="errorMessage" x-text="errorMessage"></div>

    <div class="results-section" x-show="results.length > 0">
      <h3>ğŸ–¼ï¸ Káº¿t quáº£</h3>
      <div id="resultsGallery">
        <template x-for="(url, index) in results" :key="index">
          <img :src="url" class="result-thumb" @click="openModal(url)">
        </template>
      </div>
    </div>
  </div>

  <!-- Panel lá»‹ch sá»­ -->
  <div class="history-panel" x-data="aiAppHistory()">
    <h3>ğŸ•’ Lá»‹ch sá»­ áº£nh (tá»± xÃ³a sau 24h)</h3>
    <div id="historyList">
      <template x-for="(item, index) in history" :key="index">
        <img :src="item.url" class="result-thumb" @click="openModal(item.url)">
      </template>
    </div>
  </div>
</body>
</html>
